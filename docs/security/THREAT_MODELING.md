# 脅威モデリング（STRIDE）- Memoripass v1.0.1

> 情報処理安全確保支援士 試験対策 | 実践セキュリティテスト Phase 1

---

## STRIDEとは

Microsoftが開発した脅威分類フレームワーク。設計段階で「どんな攻撃があり得るか」を体系的に考える手法。

| 頭文字 | 脅威 | 意味 |
|-------|------|------|
| **S** | Spoofing（なりすまし） | 他人になりすます |
| **T** | Tampering（改ざん） | データを不正に変更 |
| **R** | Repudiation（否認） | 「やっていない」と言い張る |
| **I** | Information Disclosure（情報漏洩） | 機密情報が漏れる |
| **D** | Denial of Service（サービス妨害） | 使えなくする |
| **E** | Elevation of Privilege（権限昇格） | 不正に権限を得る |

---

## S: なりすまし（Spoofing）

### 攻撃シナリオ
1. 他人の指紋で生体認証をバイパス
2. 偽のMemoripassアプリをインストールさせる
3. 画面ロック解除後にアプリを操作

### 現在の対策
- ✅ BIOMETRIC_STRONG（強い生体認証のみ許可）
- ✅ APK署名（偽アプリ防止）
- ✅ オートロック30秒

### 追加対策
- ✅ 起動時に必ず認証を要求（実装済み）
- 📋 root化端末への警告

### 試験ポイント
> なりすまし対策 = **認証（Authentication）** で防ぐ

---

## T: 改ざん（Tampering）

### 攻撃シナリオ
1. adbでデータベースファイルを直接書き換え
2. メモリダンプで暗号化前のパスワードを取得
3. APKを改ざんして暗号化をバイパス

### 現在の対策
- ✅ allowBackup=false（adbバックアップ不可）
- ✅ AES-256-GCM（改ざん検知付き暗号化）
- ✅ APK署名（改ざんを検知）
- ✅ 復号後のメモリゼロクリア

### 追加対策
- 📋 root化端末の検知
- 📋 デバッガー接続の検知

### 試験ポイント
> 改ざん対策 = **完全性（Integrity）** の確保
> AES-GCMの認証タグが改ざんを検知する

---

## R: 否認（Repudiation）

### 攻撃シナリオ
1. パスワードを不正変更して「変えていない」と主張
2. ログがないため証明できない

### 現在の対策
- ✅ createdAt/updatedAtタイムスタンプ

### 追加対策
- 📋 操作ログの記録（追加・変更・削除）
- 📋 ログ自体の改ざん検知

### 試験ポイント
> 否認防止 = **デジタル署名** や **監査ログ** で実現
> ログがなければ「やっていない」を否定できない

---

## I: 情報漏洩（Information Disclosure）

### 攻撃シナリオ
1. クリップボード経由の漏洩
2. スクリーンショットによる漏洩
3. 画面ショルダーハッキング
4. ログからの情報漏洩
5. メモリダンプ

### 現在の対策
- ✅ FLAG_SECURE（スクリーンショット防止）
- ✅ クリップボード30秒後自動クリア（VULN-004）
- ✅ ProGuardログ除去（VULN-005）
- ✅ 復号後のメモリゼロクリア

### 追加対策
- 📋 パスワード表示のデフォルトを非表示に

### 試験ポイント
> 情報漏洩対策 = **機密性（Confidentiality）** の確保
> CIAのCに相当する最重要項目

---

## D: サービス妨害（Denial of Service）

### 攻撃シナリオ
1. 認証失敗を繰り返してアプリをロック
2. 大量データ登録でDBを圧迫
3. 鍵を削除してデータを使用不能に

### 現在の対策
- ✅ 認証失敗5回でロック（VULN-003）

### 追加対策
- 📋 データ件数の上限設定
- 📋 鍵削除時の確認ダイアログ強化

### 試験ポイント
> DoS対策 = **可用性（Availability）** の確保
> CIAのAに相当

---

## E: 権限昇格（Elevation of Privilege）

### 攻撃シナリオ
1. root化端末でAndroid KeyStoreをバイパス
2. adb shellでアプリデータに直接アクセス
3. 開発者オプションを悪用

### 現在の対策
- ✅ StrongBox（ハードウェア保護・Titan M2）
- ✅ allowBackup=false

### 追加対策
- 📋 root化端末の検知・警告
- 📋 デバッガー接続の検知

### 試験ポイント
> 権限昇格対策 = **最小権限の原則（Least Privilege）**
> 必要最低限の権限のみ付与する設計が重要

---

## Memoripass 対策状況まとめ

| STRIDE | 脅威 | 対策状況 | 優先追加対策 |
|--------|------|---------|------------|
| S | なりすまし | ✅ 十分 | root化検知 |
| T | 改ざん | ✅ 十分 | root化検知 |
| R | 否認 | ⚠️ 不十分 | 操作ログ |
| I | 情報漏洩 | ✅ 十分 | - |
| D | サービス妨害 | ✅ 十分 | データ上限 |
| E | 権限昇格 | ⚠️ 要強化 | root化検知 |

---

## 試験頻出キーワード

| キーワード | 意味 | STRIDEとの関係 |
|-----------|------|--------------|
| 認証（Authentication） | 本人確認 | S（なりすまし）対策 |
| 完全性（Integrity） | 改ざんされていない | T（改ざん）対策 |
| 否認防止（Non-repudiation） | 行為を否定できない | R（否認）対策 |
| 機密性（Confidentiality） | 情報が漏れない | I（情報漏洩）対策 |
| 可用性（Availability） | いつでも使える | D（DoS）対策 |
| 最小権限の原則 | 必要最低限の権限 | E（権限昇格）対策 |
| 脅威モデリング | 設計段階での脅威分析 | STRIDE全体 |
| 多層防御 | 複数の対策を重ねる | STRIDE全体 |

---

*Memoripass セキュリティテスト学習記録 | Phase 1: 脅威モデリング | 2026-02-15*
